{"version":3,"sources":["../../../src/basic/List.js"],"names":["List","props","_rows","openCellId","dataArray","renderRow","rowHasChanged","r1","r2","ds","DataSource","state","dataSource","cloneWithRows","nextProps","setState","childrenArray","Children","map","children","child","enable","_listView","setNativeProps","scrollEnabled","_root","closeRow","id","closeOnRowBeginSwipe","safeCloseOpenRow","secId","rowId","rowMap","cellIdentifier","onRowOpen","closeOnRowPress","e","closeOnScroll","onScroll","ref","listViewRef","rowData","previewRowId","getRowIDForFlatIndex","previewRowIndex","row","rowSwipeGestureBegan","onRowDidOpen","onRowClose","onRowDidClose","onRowPress","setScrollEnabled","leftOpenValue","rightOpenValue","disableLeftSwipe","disableRightSwipe","stopLeftSwipe","stopRightSwipe","recalculateHiddenLayout","swipeRowStyle","previewFirstRow","previewDuration","previewOpenValue","tension","friction","directionalDistanceChangeThreshold","swipeToOpenPercent","renderLeftHiddenRow","renderRightHiddenRow","setRefs","c","renderChildren","defaultProps","StyledList"],"mappings":"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","file":"List.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { ListView, View } from \"react-native\";\r\nimport { connectStyle } from \"native-base-shoutem-theme\";\r\n\r\nimport { SwipeRow } from \"./SwipeRow\";\r\nimport mapPropsToStyleNames from \"../utils/mapPropsToStyleNames\";\r\n\r\nclass List extends Component {\r\n  static defaultProps = {\r\n    leftOpenValue: 0,\r\n    rightOpenValue: 0,\r\n    closeOnRowBeginSwipe: false,\r\n    closeOnScroll: true,\r\n    closeOnRowPress: true,\r\n    disableLeftSwipe: false,\r\n    disableRightSwipe: false,\r\n    recalculateHiddenLayout: false,\r\n    previewFirstRow: false,\r\n    directionalDistanceChangeThreshold: 2,\r\n    swipeToOpenPercent: 50\r\n  };\r\n  constructor(props) {\r\n    super(props);\r\n    this._rows = {};\r\n    this.openCellId = null;\r\n    if (props.dataArray && props.renderRow) {\r\n      let rowHasChanged = props.rowHasChanged || ((r1, r2) => r1 !== r2);\r\n      const ds = new ListView.DataSource({ rowHasChanged: rowHasChanged });\r\n      this.state = {\r\n        dataSource: ds.cloneWithRows(props.dataArray)\r\n      };\r\n    } else {\r\n      this.state = {};\r\n    }\r\n  }\r\n  componentWillReceiveProps(nextProps) {\r\n    if (this.state.dataSource) {\r\n      this.setState({\r\n        dataSource: this.state.dataSource.cloneWithRows(nextProps.dataArray)\r\n      });\r\n    }\r\n  }\r\n  renderChildren() {\r\n    const childrenArray = React.Children.map(\r\n      this.props.children,\r\n      child => child\r\n    );\r\n\r\n    return childrenArray;\r\n  }\r\n  setScrollEnabled(enable) {\r\n    this._listView.setNativeProps({ scrollEnabled: enable });\r\n  }\r\n\r\n  safeCloseOpenRow() {\r\n    // if the openCellId is stale due to deleting a row this could be undefined\r\n    if (this._rows[this.openCellId]._root) {\r\n      this._rows[this.openCellId]._root.closeRow();\r\n    }\r\n  }\r\n\r\n  rowSwipeGestureBegan(id) {\r\n    if (\r\n      this.props.closeOnRowBeginSwipe &&\r\n      this.openCellId &&\r\n      this.openCellId !== id\r\n    ) {\r\n      this.safeCloseOpenRow();\r\n    }\r\n  }\r\n\r\n  onRowOpen(secId, rowId, rowMap) {\r\n    const cellIdentifier = `${secId}${rowId}`;\r\n    if (this.openCellId && this.openCellId !== cellIdentifier) {\r\n      this.safeCloseOpenRow();\r\n    }\r\n    this.openCellId = cellIdentifier;\r\n    this.props.onRowOpen && this.props.onRowOpen(secId, rowId, rowMap);\r\n  }\r\n\r\n  onRowPress(id) {\r\n    if (this.openCellId) {\r\n      if (this.props.closeOnRowPress) {\r\n        this.safeCloseOpenRow();\r\n        this.openCellId = null;\r\n      }\r\n    }\r\n  }\r\n  closeRow(id) {\r\n    if (this.openCellId) {\r\n      if (this.props.closeOnRowPress) {\r\n        this.safeCloseOpenRow();\r\n        this.openCellId = null;\r\n      }\r\n    }\r\n  }\r\n\r\n  onScroll(e) {\r\n    if (this.openCellId) {\r\n      if (this.props.closeOnScroll) {\r\n        this.safeCloseOpenRow();\r\n        this.openCellId = null;\r\n      }\r\n    }\r\n    this.props.onScroll && this.props.onScroll(e);\r\n  }\r\n\r\n  setRefs(ref) {\r\n    this._listView = ref;\r\n    this.props.listViewRef && this.props.listViewRef(ref);\r\n  }\r\n\r\n  renderRow(rowData, secId, rowId, rowMap) {\r\n    const previewRowId =\r\n      this.props.dataSource &&\r\n      this.props.dataSource.getRowIDForFlatIndex(\r\n        this.props.previewRowIndex || 0\r\n      );\r\n    return (\r\n      <SwipeRow\r\n        list={true}\r\n        ref={row => (this._rows[`${secId}${rowId}`] = row)}\r\n        swipeGestureBegan={_ => this.rowSwipeGestureBegan(`${secId}${rowId}`)}\r\n        onRowOpen={_ => this.onRowOpen(secId, rowId, this._rows)}\r\n        onRowDidOpen={_ =>\r\n          this.props.onRowDidOpen &&\r\n          this.props.onRowDidOpen(secId, rowId, this._rows)\r\n        }\r\n        onRowClose={_ =>\r\n          this.props.onRowClose &&\r\n          this.props.onRowClose(secId, rowId, this._rows)\r\n        }\r\n        onRowDidClose={_ =>\r\n          this.props.onRowDidClose &&\r\n          this.props.onRowDidClose(secId, rowId, this._rows)\r\n        }\r\n        onRowPress={_ => this.onRowPress(`${secId}${rowId}`)}\r\n        closeRow={_ => this.closeRow(`${secId}${rowId}`)}\r\n        setScrollEnabled={enable => this.setScrollEnabled(enable)}\r\n        leftOpenValue={this.props.leftOpenValue}\r\n        rightOpenValue={this.props.rightOpenValue}\r\n        closeOnRowPress={this.props.closeOnRowPress}\r\n        disableLeftSwipe={this.props.disableLeftSwipe}\r\n        disableRightSwipe={this.props.disableRightSwipe}\r\n        stopLeftSwipe={this.props.stopLeftSwipe}\r\n        stopRightSwipe={this.props.stopRightSwipe}\r\n        recalculateHiddenLayout={this.props.recalculateHiddenLayout}\r\n        style={this.props.swipeRowStyle}\r\n        preview={\r\n          (this.props.previewFirstRow || this.props.previewRowIndex) &&\r\n          rowId === previewRowId\r\n        }\r\n        previewDuration={this.props.previewDuration}\r\n        previewOpenValue={this.props.previewOpenValue}\r\n        tension={this.props.tension}\r\n        friction={this.props.friction}\r\n        directionalDistanceChangeThreshold={\r\n          this.props.directionalDistanceChangeThreshold\r\n        }\r\n        swipeToOpenPercent={this.props.swipeToOpenPercent}\r\n        left={\r\n          this.props.renderLeftHiddenRow &&\r\n          this.props.renderLeftHiddenRow(rowData, secId, rowId, this._rows)\r\n        }\r\n        right={\r\n          this.props.renderRightHiddenRow &&\r\n          this.props.renderRightHiddenRow(rowData, secId, rowId, this._rows)\r\n        }\r\n        body={\r\n          this.props.renderRow &&\r\n          this.props.renderRow(rowData, secId, rowId, this._rows)\r\n        }\r\n      />\r\n    );\r\n  }\r\n  render() {\r\n    if (this.props.renderLeftHiddenRow || this.props.renderRightHiddenRow) {\r\n      return (\r\n        <ListView\r\n          {...this.props}\r\n          ref={ref => {\r\n            this.setRefs(ref);\r\n            this._root = ref;\r\n          }}\r\n          enableEmptySections\r\n          onScroll={e => this.onScroll(e)}\r\n          renderRow={(rowData, secId, rowId) =>\r\n            this.renderRow(rowData, secId, rowId, this._rows)\r\n          }\r\n        />\r\n      );\r\n    } else if (this.state.dataSource) {\r\n      return (\r\n        <ListView\r\n          {...this.props}\r\n          ref={ref => (this._root = ref)}\r\n          enableEmptySections\r\n          dataSource={this.state.dataSource}\r\n          renderRow={this.props.renderRow}\r\n        />\r\n      );\r\n    }\r\n    return (\r\n      <View ref={c => (this._root = c)} {...this.props}>\r\n        {this.renderChildren()}\r\n      </View>\r\n    );\r\n  }\r\n}\r\nconst StyledList = connectStyle(\"NativeBase.List\", {}, mapPropsToStyleNames)(\r\n  List\r\n);\r\n\r\nexport { StyledList as List };"]}